# Project Status (nlplot_llm Refactoring and Enhancement)

## Previous Major Refactoring (Completed)

-   [x] **1. コードレビューとリファクタリング準備**
-   [x] **2. 不要コードの削除とdocstringの最新化**
-   [x] **3. 設定の容易化・統一化**
-   [x] **4. LLMプロンプト調整の容易化**
-   [x] **5. README.md の見直しと拡充**
-   [x] **6. Sphinxドキュメント構成の確認と調整**
-   [x] **7. テストコードの拡充と実装**
-   [x] **8. streamlit_app.py の最終調整**
-   [x] **9. status.md の作成と更新 (旧タスク完了時点)**
-   [x] **10. GitHub Actions ワークフローの調整**
-   [x] **11. 変更のコミットとプルリクエスト (旧タスク完了時点)**
-   [x] **12. 今後の機能追加に関するドキュメント作成 (`FUTURE_DEVELOPMENT.md`)**

## New Feature Development: Performance Enhancements

-   [ ] **1. 現状分析と設計 (バッチ/非同期処理、キャッシュ機構)**
    -   [x] LLM呼び出し箇所の特定
    -   [x] LiteLLMのバッチ/非同期サポート調査
    -   [x] バッチ/非同期処理の設計 (非同期API追加方針、`litellm.acompletion`, `asyncio.gather`検討)
    -   [x] キャッシュ機構の設計 (`diskcache`検討、キー生成、有効期限、サイズ制限、有効化/無効化オプション設計)
    -   [x] 設定値の与え方の具体化 (コンストラクタ引数、メソッド引数)
-   [ ] **2. `status.md` の更新 (この更新)**
-   [ ] **3. キャッシュ機構の実装とテスト (TDD)**
    -   [ ] テスト作成 (Red): キャッシュ機能、キー生成、有効化/無効化
    -   [ ] 実装 (Green): `diskcache` を利用したキャッシュ機構の実装、LLMメソッドへの組込み
    -   [ ] リファクタリング (Refactor)
-   [ ] **4. バッチ処理・非同期処理の実装とテスト (TDD)**
    -   [ ] テスト作成 (Red): 非同期/バッチ処理の正常系、エラーハンドリング
    -   [ ] 実装 (Green): `litellm.acompletion` と `asyncio` を用いた非同期メソッドの実装
    -   [ ] リファクタリング (Refactor)
-   [ ] **5. Streamlitアプリへの反映（オプション検討）**
    -   [x] パフォーマンス向上の恩恵をアプリでどう反映できるか検討 (キャッシュ制御UI追加、非同期UIは見送り)
-   [x] **6. ドキュメント更新**
    -   [x] `README.md`, Sphinxドキュメント(core.pyのdocstring)への新機能説明追記 (キャッシュ、非同期API)
    -   [x] `FUTURE_DEVELOPMENT.md` の更新 (キャッシュ、非同期API実装状況を反映)
-   [x] **7. 最終テストとレビュー**
    -   [x] テストスイート全体のパス確認（想定）
    -   [x] 追加・修正コードのセルフレビュー（キャッシュキー、非同期処理、エラーハンドリング）
    -   [x] ドキュメントの整合性セルフレビュー
-   [x] **8. `status.md` の最終更新** (この更新)
-   [ ] **9. 変更のコミットとプルリクエスト**

**進捗:**
新機能開発（キャッシュ機構、非同期処理API）に関する全ての計画ステップが完了。残りはコミットとプルリクエストのみ。
